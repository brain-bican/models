id: https://identifiers.org/brain-bican/kb-model
name: kb-model
prefixes:
  linkml: https://w3id.org/linkml/
  #biolink: https://w3id.org/biolink/vocab/
  biolink: https://raw.githubusercontent.com/biolink/biolink-model/master/
  bican: https://identifiers.org/brain-bican/vocab/
  spdx: http://spdx.org/rdf/terms#
  schema: http://schema.org/
  ncbi: https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id=
  NCBIAssembly: https://www.ncbi.nlm.nih.gov/assembly/
  prov: http://www.w3.org/ns/prov#


imports:
  - linkml:types
  - biolink:biolink-model
default_range: string
default_prefix: bican

classes:
  gene annotation:
    is_a: gene
    description: >-
      An annotation describing the location, boundaries, and functions of 
      individual genes within a genome annotation.
    slots:
      - molecular type
      - source id
    attributes:
      referenced in: 
        description: The genome annotation that this gene annotation was referenced from.
        required: true
        inlined: true
        any_of:
          - range: genome annotation
          - range: string
    id_prefixes:
      - ENSEMBL
      - MGI
      - NCBIGene

  genome annotation:
    is_a: genome
    description: >-
      Location and nomenclature of genes and all of the coding regions in a genome assembly 
      and the classification of genes and transcripts into types.
    slots:
      - version
      - digest
      - content_url
      - authority
    attributes:
      reference assembly:
        description: The reference genome assembly that this genome annotation was created from.
        required: true
        inlined: true
        any_of:
          - range: genome assembly
          - range: string

  genome assembly:
    is_a: named thing
    mixins:
      - thing with taxon
    description: >-
      Genome assembly to contain version and label information
    slots:
      - version
      - strain

  checksum:
    is_a: material sample
    description: >-
      Checksum values associated with digital entities.
    slots:
      - checksum algorithm
    attributes:
      value: 
        description: The checksum value obtained from a specific cryotographic hash function.

  annotation collection:
    tree_root: true
    attributes:
      annotations:
        multivalued: true
        inlined_as_list: true
        range: gene annotation
      genome_annotations:
        multivalued: true
        inlined_as_list: true
        range: genome annotation
      genome_assemblies:
        multivalued: true
        inlined_as_list: true
        range: genome assembly

  prov activity:
    mixin: true
    description: >-
      Based off prov:Activity; an activity is something that occurs over a period of time and acts upon or with entities; 
      it may include consuming, processing, transforming, modifying, relocating, using, or generating entities.
    slots:
      - used
      - generated
      - wasAssociatedWith


  brain extraction:
    description: >-
      A process that takes a brain sample from a donor and produces a brain segment.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: donor
      generated:
        range: brain segment

  brain segment sectioning:
    description: >-
      A process that takes a brain segment and produces a brain section.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: brain segment
      generated:
        range: brain section

  tissue dissecting:
    description: >-
      A process that takes a brain section and produces a tissue sample.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: brain section
      generated:
        range: tissue sample

  cell dissociation:
    description: >-
      A process that takes a tissue sample and produces a dissociated cell sample.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: tissue sample
      generated:
        range: dissociated cell sample

  cell enrichment:
    description: >-
      A process that takes a dissociated cell sample and produces an enriched cell sample.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: dissociated cell sample
      generated:
        range: enriched cell sample 

  cell barcoding:
    description: >-
      A process that takes an enriched cell sample and produces a barcoded cell sample.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: enriched cell sample
      generated:
        range: barcoded cell sample

  cdna amplification:
    description: >-
      A process that takes a barcoded cell sample and produces an amplified cDNA sample.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: barcoded cell sample
      generated:
        range: amplified cdna
  
  library construction:
    description: >-
      A process that takes an amplified cDNA sample and produces a library.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: amplified cdna
      generated:
        range: library
  
  library aliquoting:
    description: >-
      A process that takes a library and produces an library aliquot.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: library
      generated:
        range: library aliquot

  library pooling:
    description: >-
      A process that takes a library aliquot and produces a library pool.
    is_a: activity
    mixins: 
      - prov activity
    slot_usage:
      used:
        range: library aliquot
      generated:
        range: library pool


  prov entity:
    mixin: true
    description: >-
      Based off prov:Entity; an entity is a physical, digital, conceptual, or other kind of thing with some fixed aspects; 
      entities may be real or imaginary.
    slots:
      - wasDerivedFrom
      - wasGeneratedBy
      - wasAttributedTo


  # 028 - donors.ipynb
  # age_at_death -> death age, date_of_birth -> birth date, date_of_death -> death date, full_genotype -> full genotype,
  # entity_type -> type/category, label -> name, ncbitaxonomyid -> in_taxon, sex -> sex
  donor:
    is_a: agent
    mixins:
      - thing with taxon
    description: >-
      A person or organism that is the source of a biological sample.
    slots:
      - sex
      - birth date
      - death date
      - death age
      - full genotype


  # 027 - brain_extraction.ipynb
  # mappings (notebook -> model): anatomical_division -> anatomical division, barcode -> id, 
  # (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category, label -> name
  brain segment:
    is_a: entity
    mixins:    
      - prov entity
    attributes:
      anatomical division:
    slot_usage:
      wasGeneratedBy:
        range: brain extraction
      wasDerivedFrom:
        range: donor
    

  # 026 - brain_segment_sectioning.ipynb
  # mappings (notebook -> model): barcode -> id, (created_by_process_id & created_by_process_type) -> wasGeneratedBy, 
  # entity_type -> type/category, label -> name, ordinal -> ordinal
  brain section:
    is_a: entity
    mixins:    
      - prov entity
    attributes:
      ordinal:
        description: The ordinal number of the section.
        range: integer
    slot_usage:
      wasGeneratedBy:
        range: brain segment sectioning
      wasDerivedFrom:
        range: brain segment


  # 025b - tissue_dissectioning.ipynb
  # mappings (notebook -> model): (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category,
  # label -> name, roi_plan -> roi plan, roi_label -> roi label 
  tissue sample:
    is_a: entity
    mixins:    
      - prov entity
    attributes:
      roi plan:
      roi label:
        description: The label of the region of interest.
    slot_usage:
      wasGeneratedBy:
        range: tissue dissecting
      wasDerivedFrom:
        range: brain section


  # 024 - cell_dissociation.ipynb
  # mappings (notebook -> model): cell_prep_type -> cell prep type, (created_by_process_id & created_by_process_type) -> wasGeneratedBy, 
  # entity_type -> type/category, facs_population_plan -> facs population plan, label -> name, number_of_cells_collected -> num cells collected
  dissociated cell sample:
    is_a: entity
    mixins:    
      - prov entity
    attributes:
      cell prep type:
      facs population plan: 
      num cells collected:
        range: integer
    slot_usage:
      wasGeneratedBy:
        range: cell dissociation
      wasDerivedFrom:
        range: tissue sample


  enriched cell sample:
    is_a: entity
    mixins:    
      - prov entity
    slot_usage:
      wasGeneratedBy:
        range: cell enrichment
      wasDerivedFrom:
        range: dissociated cell sample


  # 023 - cell_barcoding.ipynb
  # mappings (notebook -> model): (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category, 
  # label -> name, port_well -> port well, sample_quality_count -> sample quality count 
  barcoded cell sample:
    is_a: entity
    mixins:    
      - prov entity
    attributes:
      port well:
      sample quality count:
    slot_usage:
      wasGeneratedBy:
        range: cell barcoding
      wasDerivedFrom:
        range: enriched cell sample


  # 022 - cnda_amplification.ipynb
  # amplified_quantity_ng -> input quantity, (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category,
  # label -> name, method -> method, pcr_cycles -> pcr cycles, percent_cdna_longer_than_400bp -> percent cdna longer than 400bp, rna_amplification_pass_fail -> process pass
  amplified cdna:
    is_a: entity
    mixins:    
      - prov entity
    slots:
      - method
      - input quantity
      - process pass
    attributes:
      pcr cycles:
        description: >-
          Number of PCR cycles used to amplify the cDNA.
        range: integer
      percent cdna longer than 400bp:
        description: >-
          The percentage of cDNA fragments that are longer than 400bp.
        range: float
    slot_usage:
      input quantity:
        description: The amount of input cDNA (ng) amplified.
      process pass:
        description: Indicates whether the rna amplification process passed or failed.
      wasGeneratedBy:
        range: cdna amplification
      wasDerivedFrom:
        range: barcoded cell sample


  # 021 - library_constructions.ipynb
  # avg_size_bp -> avg size bp, (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category, label -> name,
  # library_creation_date -> creation date, library_input_ng -> input quantity, method -> method, process_pass -> process pass, 
  # quantification_fmole -> quantification fmol, quantification_ng -> quantification ng, quantification_nm -> quantification nm,
  # r1_index -> r1 index, r1_sequence -> r1 sequence, r2_index -> r2 index, r2_sequence -> r2 sequence
  library:
    is_a: entity
    mixins:    
      - prov entity
    slots:
      - method 
      - creation date
      - input quantity
      - process pass
      - avg size bp
    attributes:
      quantification fmol:
        range: float
      quantification ng:
        range: float
      quantification nm: 
        range: float
      r1 index:
      r1 sequence:
      r2 index:
      r2 sequence:
    slot_usage:
      creation date:    
        description: The date and time the object was created. 
        range: datetime
      input quantity:
        description: The amount of input material (ng) used to create the library.
      process pass:
        description: Indicates whether the library prep process passed or failed.
      avg size bp:
        description: The average size (bp) of the library fragments.
      wasGeneratedBy:
        range: library construction
      wasDerivedFrom:
        range: amplified cdna
       

  # 020 - aliquoting_and_pooling.ipynb
  # mappings (notebook -> model): label -> name, input_quantity_fmol -> input quantity, library_label -> xref,
  # (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category, 
  library aliquot:
    is_a: entity
    mixins:    
      - prov entity
    slots:
      - input quantity
    slot_usage:
      wasGeneratedBy:
        range: library aliquoting
      wasDerivedFrom:
        range: library
      input quantity:
        description: The amount of input material (fmol) used to create the library aliquot.
        range: integer


  # 020 - aliquoting_and_pooling.ipynb
  # mappings (notebook -> model): label -> name, tube_avg_size_bp -> avg size bp, tube_contents_nm -> tube contents nm, tube_internal_label -> xref,
  # (created_by_process_id & created_by_process_type) -> wasGeneratedBy, entity_type -> type/category, 
  library pool:
    is_a: entity
    mixins:    
      - prov entity
    slots:
      - avg size bp
    attributes:
      tube contents:
        description: The content concentration (nm).
        range: float
    slot_usage:
      avg size bp:
        description: The average size (bp) of the library fragments in the tube.
      wasGeneratedBy:
        range: library pooling
      wasDerivedFrom:
        range: library aliquot


slots:
  used:
    slot_uri: prov:used
    domain: activity
    range: entity 
    multivalued: true
    inlined_as_list: true

  generated:
    slot_uri: prov:generated
    domain: activity
    range: entity
    multivalued: true
    inlined_as_list: true
  
  wasGeneratedBy:
    slot_uri: prov:wasGeneratedBy
    domain: entity
    range: activity
    multivalued: true
    inlined_as_list: true

  wasDerivedFrom:
    slot_uri: prov:wasDerivedFrom
    domain: entity
    range: entity
    multivalued: true
    inlined_as_list: true
  
  wasAssociatedWith:
    slot_uri: prov:wasAssociatedWith
    domain: activity
    range: agent
    multivalued: true
    inlined_as_list: true
  
  wasAttributedTo:
    slot_uri: prov:wasAttributedTo
    domain: entity
    range: agent
    multivalued: true
    inlined_as_list: true

  molecular type:
    any_of:
      - range: BioType
      - range: string

  digest:
    description: Stores checksum information. 
    multivalued: true
    inlined_as_list: true
    any_of:
      - range: checksum
      - range: string

  content_url:
    slot_uri: schema:url
    multivalued: true

  authority:
    description: The organization responsible for publishing the data. 
    range: AuthorityType

  checksum algorithm:
    description: The type of cryptographic hash function used to calculate the checksum value.
    range: DigestType

  source id:
    description: The authority specific identifier. 
    slot_uri: schema:identifier
  
  strain:
    description: The genetic variant or subtype of a species or organism. 

  sex:
    range: SexType  
  
  birth date:
    description: The date of birth of the donor.
    range: date

  death date:
    description: The date of death of the donor.
    range: date
  
  death age:
    description: The age of the donor at the time of death (ISO 8601 format).
    range: string

  full genotype:  
    description: The full genotype of the donor.
    range: string

  method:
    description: 
    slot_uri: schema:name
  
  input quantity:
    description: The amount of input material used for an activity. 
    range: float
  
  process pass:
    description: Indicates whether the process passed or failed. 
    range: boolean
  
  avg size bp:
    description: The average size (bp = base pairs) of an entity. 
    range: integer


enums:
  DigestType:
    permissible_values:
      SHA1:
        meaning: spdx:checksumAlgorithm_sha1
      MD5:
        meaning: spdx:checksumAlgorithm_md5
      SHA256:
        meaning: spdx:checksumAlgorithm_sha256

  SexType:
    permissible_values:
      female:
      male:

  BioType:
    permissible_values:
      protein_coding:
      noncoding:

  AuthorityType: 
    permissible_values:
      ENSEMBL:
      NCBI: